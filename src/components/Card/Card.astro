---
import type { CollectionEntry } from "astro:content";
import CardImage from "./components/CardImage.astro";
import CardTitle from "./components/CardTitle.astro";
import CardDescription from "./components/CardDescription.astro";
import CardMeta from "./components/CardMeta.astro";
import CardTags from "./components/CardTags.astro";

type BlogPost = CollectionEntry<"blog">;

interface Props {
  post: BlogPost;
  variant?: "vertical" | "horizontal";
  showImage?: boolean;
  linkTags?: boolean;
  headingLevel?: "h2" | "h3";
  class?: string;
}

const {
  post,
  variant = "vertical",
  showImage = true,
  linkTags = true,
  headingLevel = "h2",
  class: className = "",
} = Astro.props;

const isHorizontal = variant === "horizontal";
---

<article
  class:list={[
    "card relative rounded-2xl bg-slate-50 dark:bg-slate-800 overflow-hidden",
    {
      "xl:max-h-[210px] xl:flex xl:flex-row": isHorizontal,
    },
    className,
  ]}
>
  {showImage && post.data.heroImage && (
    <CardImage
      src={post.data.heroImage}
      alt={post.data.title}
      variant={variant}
    />
  )}

  <div class="p-6 flex-1 overflow-hidden">
    <CardTitle
      title={post.data.title}
      href={`/blog/${post.slug}`}
      level={headingLevel}
    />

    <CardDescription
      description={post.data.description}
      truncate={isHorizontal}
    />

    <CardMeta date={post.data.date} body={post.body} />

    {post.data.tags && (
      <CardTags tags={post.data.tags} linked={linkTags} />
    )}
  </div>
</article>
